# IPTABLES
## Background

There are 5 tables which you spesify with `-t`. Each table contains "chains".
* filter (default):
  - INPUT: (for  packets  destined  to  local  sockets)
  - FORWARD: (for packets being through the box)
  - OUTPUT: (for locally-generated packets)
* nat: This table is consulted when a packet that creates a new connection is encountered.
  - PREROUTING (for altering packets as soon as they come in)
  - INPUT (for altering packets destined for local sockets)
  - OUTPUT (for altering locally generated packets before routing)
  - POSTROUTING (for altering packets as they are about to go out).
* mangle: Used for specialized packet alteration.
  - PREROUTING (for altering incoming packets before routing) 
  - OUTPUT (for altering locally-generated packets before routing)
  - INPUT (for packets coming into the box itself)
  - FORWARD (for altering packets being routed through  the  box)
  - POSTROUTING (for altering packets as they are about to go out).
* raw: Used mainly for configuring exemptions from connection tracking in combiation with the NOTRACK target. Called before filter. 
  - PREROUTING (for packets arriving via any network  interface) 
  - OUTPUT (for packets generated by local processes)
* security: Used for Mandatory Access Control (MAC) networking rules (SELinux). Called after filter table.
  - INPUT (for packets coming into the box itself)
  - OUTPUT (for altering locally generated  packets before routing)
  - FORWARD (for altering packets being routed through the box).
## Flags
* `-A`: append to a chain 
* `-t`: spesify a table
* `-i`: input-interface name
* `-o`: output-interface name
* `-m`: Specifies a match to use
* `-j`: jump target (what to do if the packet matches this rule)
* `-L`: list a chain
* `-n`: jump target (what to do if the packet matches this rule)
* `-v`: jump target (what to do if the packet matches this rule)

## Look up firewall rules
sudo iptables -L -n -v
sudo iptables -t nat -L -n -v

## Clear iptables
`iptables -F`
* Flush the selected chain (all the chains in the table if none is given). 
* Doesn't kill the default chains (INPUT, FORWARD, OUTPUT)
`iptables -X` 
* delete-chain [chain]
* Doesn't kill the default chains (INPUT, FORWARD, OUTPUT)

### Nuke the rules!!!
```
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -t nat -F
iptables -t mangle -F
iptables -F
iptables -X
```

